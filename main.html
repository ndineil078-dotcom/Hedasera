<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hedasera | Feed</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Styles from previous version + fixes */
        body { margin: 0; background: #DAE0E6; font-family: 'Inter', sans-serif; }
        .navbar { background: #fff; padding: 10px 0; border-bottom: 1px solid #ccc; display: flex; justify-content: center; align-items: center; position: sticky; top: 0; z-index: 100; }
        .logo-container { position: relative; width: 250px; height: 100px; display: flex; align-items: center; justify-content: center; }
        .main-logo-img { width: 100px; height: auto; }
        .brand-name-overlay { position: absolute; font-family: 'Dancing Script'; font-size: 52px; pointer-events: none; text-shadow: 2px 2px 4px #fff; }
        
        .container { display: grid; grid-template-columns: 260px 1fr 300px; gap: 20px; padding: 20px; max-width: 1400px; margin: auto; }
        .card { background: #fff; padding: 15px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 20px; }
        
        .slideshow-container { width: 100%; height: 220px; background: #000; border-radius: 8px; overflow: hidden; margin-bottom: 20px; position: relative; }
        .slide { display: none; height: 100%; background-size: cover; background-position: center; cursor: pointer; }
        .slide-text { position: absolute; bottom: 0; background: rgba(0,0,0,0.7); color: #fff; width: 100%; padding: 15px; }

        .feed-post { background: #fff; border: 1px solid #ccc; padding: 15px; border-radius: 8px; margin-bottom: 15px; display: flex; gap: 15px; }
        .vote-sidebar { display: flex; flex-direction: column; align-items: center; width: 45px; }
        .vote-btn { background: none; border: none; font-size: 20px; cursor: pointer; color: #878a8c; }
        .vote-btn.up.active { color: #ff4500; }
        .vote-btn.down.active { color: #7193ff; }
        
        .community-item { display: flex; align-items: center; padding: 10px; cursor: pointer; border-radius: 6px; font-weight: bold; text-decoration: none; color: #000; }
        .community-item:hover { background: #f0f0f0; }
        .pfp { width: 30px; height: 30px; border-radius: 50%; margin-right: 10px; }

        #transition-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; transform: scaleY(0); transform-origin: bottom; transition: transform 0.6s ease-in-out; pointer-events: none; }
        #transition-overlay.herrera { transform: scaleY(1); background: radial-gradient(circle, #660000, #000); }
        #transition-overlay.mejorada { transform: scaleY(1); background: radial-gradient(circle, #0044ff, #000); }
    </style>
</head>
<body>

<div id="transition-overlay"></div>

<div class="navbar">
    <div class="logo-container">
        <img src="logo.png" class="main-logo-img">
        <h1 class="brand-name-overlay">Hedasera</h1>
    </div>
</div>

<div class="container">
    <div class="sidebar">
        <div class="card">
            <h4 style="color: gray;">COMMUNITIES</h4>
            <div onclick="startTransition('herrera.html', 'herrera')" class="community-item">
                <div class="pfp" style="background:#1a1a1a;"></div> h/Herrera
            </div>
            <div onclick="startTransition('mejorada.html', 'mejorada')" class="community-item">
                <div class="pfp" style="background:#0044ff;"></div> h/Mejorada
            </div>
            <div class="community-item"><div class="pfp" style="background:#ffcc00;"></div> h/Sentin</div>
            <div class="community-item"><div class="pfp" style="background:#cc00ff;"></div> h/Mejorada2</div>
            <hr>
            <a href="about.html" class="community-item" style="color:#0079d3;">> About Hedasera</a>
            <a href="index.html" class="community-item" style="color:#ff0000;">> LOGOUT</a>
        </div>
    </div>

    <div class="feed">
        <div class="slideshow-container">
            <div class="slide" style="background-image:url('https://via.placeholder.com/800x250/1a1a1a/fff?text=The+Wired+Data+Stream'); display:block;">
                <div class="slide-text"><h3>Entry 01: The Wired Boundary</h3><p>Click to access data packet...</p></div>
            </div>
            <div class="slide" style="background-image:url('https://via.placeholder.com/800x250/0044ff/fff?text=Efficiency+Evolution');">
                <div class="slide-text"><h3>Entry 02: Efficiency Evolution</h3><p>Data stream active.</p></div>
            </div>
        </div>

        <div id="feed-container"></div>
    </div>

    <div class="social-panel">
        <div class="card">
            <img src="facebook.jpg" width="20"> <strong>Facebook Socials</strong>
            <ul style="font-size: 14px; list-style:none; padding:10px 0;">
                <li>â€¢ <a href="https://facebook.com" target="_blank">Thirdy Herrera</a></li>
                <li>â€¢ <a href="https://facebook.com" target="_blank">Dayao Kenzo</a></li>
            </ul>
        </div>
        <div class="card">
            <img src="discord.jpg" width="20"> <strong>Discord Socials</strong>
            <ul style="font-size: 14px; list-style:none; padding:10px 0;">
                <li>â€¢ <a href="https://discord.com" target="_blank">Yoshi_Keru</a></li>
                <li>â€¢ <a href="https://discord.com" target="_blank">Kenz09</a></li>
            </ul>
        </div>
    </div>
</div>

<script>
    const user = localStorage.getItem('hedasera_user');
    
    const postDB = [
        { id: 1, community: 'h/Herrera', user: 'Thirdy', title: 'DO YOU AGREE?', content: 'People procrastinate because tasks feel big...', votes: 16700, time: Date.now() - 79200000, color: '#1a1a1a' },
        { id: 2, community: 'h/Sentin', user: 'Hanna', title: 'SHOULD WE?', content: 'More educational coding for programming students?', votes: 6100, time: Date.now() - 64800000, color: '#ffcc00' },
        // ... imagine 8 more posts here
    ];

    let posts = JSON.parse(localStorage.getItem('posts')) || postDB;
    let userVotes = JSON.parse(localStorage.getItem('userVotes')) || {};

    function timeAgo(date) {
        const seconds = Math.floor((new Date() - date) / 1000);
        if (seconds < 3600) return Math.floor(seconds/60) + "m ago";
        if (seconds < 86400) return Math.floor(seconds/3600) + "hr ago";
        return Math.floor(seconds/86400) + "d ago";
    }

    function render() {
        const container = document.getElementById('feed-container');
        container.innerHTML = '';
        posts.forEach(p => {
            const hasVoted = userVotes[p.id] || null;
            container.innerHTML += `
                <div class="feed-post">
                    <div class="vote-sidebar">
                        <button class="vote-btn up ${hasVoted==='up'?'active':''}" onclick="vote(${p.id}, 'up')">â–²</button>
                        <div style="font-weight:bold">${(p.votes/1000).toFixed(1)}k</div>
                        <button class="vote-btn down ${hasVoted==='down'?'active':''}" onclick="vote(${p.id}, 'down')">â–¼</button>
                    </div>
                    <div>
                        <small><b>${p.community}</b> â€¢ ${p.user} â€¢ ${timeAgo(p.time)}</small>
                        <h2>${p.title}</h2>
                        <p>${p.content}</p>
                        <button class="vote-btn" onclick="alert('Link Copied!')">ðŸ”— Share</button>
                    </div>
                </div>`;
        });
    }

    function vote(id, type) {
        if (!user || user === 'null') return alert("Anonymous users cannot vote!");
        const post = posts.find(x => x.id === id);
        if (userVotes[id] === type) {
            post.votes += (type === 'up' ? -1 : 1);
            delete userVotes[id];
        } else {
            if (userVotes[id]) post.votes += (userVotes[id] === 'up' ? -1 : 1);
            post.votes += (type === 'up' ? 1 : -1);
            userVotes[id] = type;
        }
        localStorage.setItem('posts', JSON.stringify(posts));
        localStorage.setItem('userVotes', JSON.stringify(userVotes));
        render();
    }

    function startTransition(url, type) {
        const overlay = document.getElementById('transition-overlay');
        overlay.className = type;
        setTimeout(() => window.location.href = url, 600);
    }

    // Slideshow
    let sIdx = 0;
    function runSlides() {
        let slides = document.getElementsByClassName("slide");
        for (let i=0; i<slides.length; i++) slides[i].style.display = "none";
        sIdx++; if(sIdx > slides.length) sIdx = 1;
        slides[sIdx-1].style.display = "block";
        setTimeout(runSlides, 4000);
    }

    runSlides();
    render();
</script>
</body>
</html>